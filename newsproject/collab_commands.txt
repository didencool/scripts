!pip install feedparser transformers sentencepiece langdetect requests beautifulsoup4

from google.colab import drive
drive.mount('/content/drive')

SOURCES_FILE = "/content/drive/MyDrive/Colab Notebooks/newsproject/newsfeed.txt"
NEWS_LIMIT = 5 # Кількість новин на одне джерело

%cd

%%writefile dataloader.py
%%writefile nlp_processory.py

!git config --global user.email "didencool@gmail.com"
!git config --global user.name "Andrii Didenkul"

def process_and_analyze_news(articles: List[Dict]) -> List[Dict]:
    """Головний цикл обробки: переклад."""
    processed_articles = []
    print(f"\nРозпочато обробку {len(articles)} новин...")

    for article in articles:
        translated_article = translate_to_uk(article)
        processed_articles.append(translated_article)

    return processed_articles


if __name__ == "__main__":

    # 1. Завантаження джерел
    rss_sources = load_sources(SOURCES_FILE)

    if not rss_sources:
        print("Неможливо продовжити: список джерел порожній.")
    else:
        # 2. Збір новин
        collected_articles = fetch_news(rss_sources, NEWS_LIMIT)

        # 3. Обробка та аналіз
        final_results = process_and_analyze_news(collected_articles)

        # 4. Вивід результатів
        print(f"\nПриклади оброблених новин:")
        for i, article in enumerate(final_results):
            print(f"--- Новина {i+1} ---")
            print(f"  Джерело: {article.get('source', '')[:40]}...")
            print(f"  Оригінал [{article.get('lang', 'N/A')}]: {article.get('title', 'N/A')}")
            print(f"  Переклад [uk]: {article.get('ukr_title', 'N/A')}")
